# 子空间辨识（N4SID）方法

**N4SID（Nonlinear Four-Step Subspace Identification）** 是一种用于系统辨识的方法，特别适用于从输入输出数据估计线性时不变系统的状态空间模型。它利用奇异值分解（SVD）等矩阵运算来提取系统的动态特性。

## N4SID 的基本步骤

N4SID 方法包含四个步骤，主要用于从输入输出数据中估计线性系统的状态空间模型：

### 1. 数据矩阵的构造

首先，通过输入信号 $$u(t) $$ 和输出信号 $$ y(t) $$ 构造两个数据矩阵：

- **输入矩阵 $$ U $$**：每一列对应于输入信号在不同时间步的延迟。
- **输出矩阵 $$Y $$**：每一列对应于输出信号在不同时间步的延迟。

假设我们有 $$N $$个采样点，数据矩阵 $$ U  $$ 和 $$ Y $$ 可以表示为：

$$
U = \begin{bmatrix} 
u(1) & u(2) & \cdots & u(N-1) \\
u(2) & u(3) & \cdots & u(N) \\
\vdots & \vdots & \ddots & \vdots \\
u(N-1) & u(N) & \cdots & u(2N-2)
\end{bmatrix}
$$

$$
Y = \begin{bmatrix} 
y(1) & y(2) & \cdots & y(N-1) \\
y(2) & y(3) & \cdots & y(N) \\
\vdots & \vdots & \ddots & \vdots \\
y(N-1) & y(N) & \cdots & y(2N-2)
\end{bmatrix}
$$

### 2. 奇异值分解（SVD）

使用奇异值分解SVD将数据矩阵分解为三个矩阵，帮助提取系统的主要动态特性。奇异值分解可以帮助我们提取出输入输出数据的主要成分。

给定输入矩阵 $$ U $$ 和输出矩阵 $$ Y  $$，奇异值分解结果为：

$$
U = U_1 \Sigma U_2^T
$$

$$
Y = Y_1 \Sigma Y_2^T
$$

其中 $$ U_1 $$ 和 $$ Y_1  $$ 是正交矩阵，$$ \Sigma  $$ 是对角矩阵，包含了数据的主要特征（即奇异值）。

### 3. 计算系统的状态空间维度

通过奇异值分解的结果，我们可以确定系统的状态空间维度。系统的维度通常由显著的奇异值数量决定。选择这些显著的奇异值并忽略较小的奇异值，能够帮助我们确定系统的维度。

### 4. 提取系统的状态空间矩阵

利用已知的状态空间维度和奇异值分解结果，提取出状态空间模型的各个矩阵（$$ A  $$, $$ B $$, $$ C  $$, $$ D  $$）：

- **状态矩阵 $$ A $$**：通过矩阵分解得到的 $$ U_1  $$ 和 $$ Y_1  $$ 可用来估计系统的状态转移矩阵 $$ A  $$。
- **输入矩阵 $$ B  $$** 和 **输出矩阵 $$ C $$**：根据输入输出数据矩阵的关系来估计 $$ B  $$ 和 $$ C  $$。
- **直接传递矩阵 $$ D  $$**：如果没有直接输入到输出的影响，则 $$ D  $$ 可能为零。

这些矩阵最终组成了系统的状态空间模型，描述了系统的动态行为。

## N4SID 的数学原理

N4SID 方法利用矩阵的子空间结构，通过奇异值分解（SVD）和矩阵运算，捕捉系统的动态特性。其核心数学原理包括：

- **奇异值分解（SVD）**：SVD 是一种将矩阵分解为三个矩阵的技术，用于从输入输出数据中提取系统的动态特性。
- **线性系统理论**：N4SID 假设系统是线性的，利用线性系统的状态空间模型来描述系统的行为。
- **最小二乘法**：子空间辨识方法通过最小化误差来优化模型参数，使模型输出尽可能接近实际输出数据。

## N4SID 的优点

- **非参数化方法**：N4SID 不依赖于系统的先验模型，它仅通过输入输出数据来估计模型，适用于没有明确模型假设的情况。
- **处理高维系统**：N4SID 可以处理较高维度的系统，并有效从大量数据中提取系统的动态特性。
- **适用于大规模数据集**：通过矩阵运算和奇异值分解，N4SID 能够高效地处理大规模数据集。

## 总结

**N4SID（子空间辨识）** 是一种基于输入输出数据的系统辨识方法，通过奇异值分解提取系统的动态特性。它不依赖于任何系统模型的假设，而是通过对数据的数学处理估计系统的状态空间模型。N4SID 适用于高维和大规模数据集，并能有效辨识